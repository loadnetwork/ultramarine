schema_version: 1

network:
  name: example
  chain_id: 16383

# Container images pinned by tag (MVP). M4 can add optional digests.
images:
  ultramarine: "ultramarine:local"
  load_reth: "docker.io/loadnetwork/load-reth:v0.1.2"

# Hosts are the failure domains. For public testnets, these should be public IPs/DNS.
hosts:
  - id: host-0
    public_ip: "203.0.113.10"
    ssh_user: ubuntu
  - id: host-1
    public_ip: "203.0.113.11"
    ssh_user: ubuntu
  - id: host-2
    public_ip: "203.0.113.12"
    ssh_user: ubuntu

# Nodes are CL+EL pairs and must be co-located (one node references one host).
nodes:
  - id: node-0
    host: host-0
    role: validator
  - id: node-1
    host: host-1
    role: validator
  - id: node-2
    host: host-2
    role: validator

# Engine API policy for deploys: IPC-only.
engine:
  mode: ipc
  ipc_path_template: "/run/load-reth/{node_id}/engine.ipc"

# Port allocation is deterministic. "host-block" matches the devnet pattern:
# host index 0 => 8545/30303/9001, host index 1 => 9545/31303/10001, etc.
ports:
  allocation: host-block
  # Use 1000 to stay under 65535 for typical base ports across more hosts.
  host_block_stride: 1000
  el:
    http: 8545
    p2p: 30303
    metrics: 9001
  cl:
    p2p: 27000
    mempool: 28000
    metrics: 29000

# ValueSync must be enabled for multi-host networks.
sync:
  enabled: true

# Validators require archiver. The generator enforces presence of provider+token.
archiver:
  enabled: true
  provider_url: "https://archiver.example.com"
  provider_id: "example"
  # Per-node bearer tokens come from decrypted secrets input (not stored here).

# Metrics exposure policy: "localhost" is safest for public testnets without centralized Prometheus.
# Use SSH port-forwarding for debugging.
exposure:
  metrics_bind: "127.0.0.1"
