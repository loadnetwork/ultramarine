schema_version: 1

network:
  name: fibernet
  chain_id: 1984

# Execution genesis (alloc) for fibernet.
execution:
  alloc:
    # Treasury / operator address (50% of supply: 5_000_000 / 10_000_000).
    - address: "0x197f818c1313dc58b32d88078ecdfb40ea822614"
      balance_wei: "5000000000000000000000000"
    # Spam/blobs funding account (remaining supply: 50%).
    - address: "0x2411c6e43299a09d2225d58e9e7977237b3e4c49"
      balance_wei: "5000000000000000000000000"

# Container images pinned by tag (MVP). M4 can add optional digests.
images:
  ultramarine: "docker.io/loadnetwork/ultramarine:fibernet"
  load_reth: "docker.io/loadnetwork/load-reth:fibernet"

# Hosts are the failure domains. For public testnets, these should be public IPs/DNS.
hosts:
  - id: f4-metal-medium-lon2-fibernet-1
    public_ip: "67.213.117.143"
    ssh_user: ubuntu
  - id: f4-metal-medium-ams-fibernet-2
    public_ip: "64.34.87.1"
    ssh_user: ubuntu
  - id: f4-metal-medium-fra2-fibernet-2
    public_ip: "67.213.121.57"
    ssh_user: ubuntu
  # Dedicated host for Blockscout explorer + full node (Xeon E-2286G, 32GB RAM, 1TB SSD)
  - id: blockscout-fibernet
    public_ip: "72.46.84.15"
    ssh_user: ubuntu

# 6 validators: 2 per host (3x2 topology)
nodes:
  - id: node-0
    host: f4-metal-medium-lon2-fibernet-1
    role: validator
  - id: node-1
    host: f4-metal-medium-lon2-fibernet-1
    role: validator
  - id: node-2
    host: f4-metal-medium-ams-fibernet-2
    role: validator
  - id: node-3
    host: f4-metal-medium-ams-fibernet-2
    role: validator
  - id: node-4
    host: f4-metal-medium-fra2-fibernet-2
    role: validator
  - id: node-5
    host: f4-metal-medium-fra2-fibernet-2
    role: validator
  # Full node for Blockscout indexing and public RPC (non-validator)
  - id: node-rpc
    host: blockscout-fibernet
    role: fullnode

# Engine API policy for deploys: IPC-only.
engine:
  mode: ipc
  ipc_path_template: "/run/load-reth/{node_id}/engine.ipc"

# Port allocation is deterministic. "host-block" is easiest to operate.
ports:
  allocation: host-block
  host_block_stride: 1000
  el:
    http: 8545
    authrpc: 8551
    p2p: 30303
    metrics: 9001
  cl:
    p2p: 27000
    mempool: 28000
    metrics: 29000

# ValueSync must be enabled for multi-host networks.
sync:
  enabled: true
  # Global sync tuning (applies to ALL nodes: validators + fullnodes).
  # Blocks with 1024 blobs can be ~134 MB; default 10 MiB response limit is too small.
  # Load tests can produce blocks up to 6 MB - increase all limits accordingly.
  max_request_size: "50 MiB"
  max_response_size: "500 MiB"
  request_timeout: "60s"
  parallel_requests: 100
  batch_size: 5
  # Fullnode-specific sync tuning (overrides global for non-validator nodes).
  fullnode:
    parallel_requests: 100
    request_timeout: "60s"
    max_response_size: "500 MiB"
    batch_size: 10

# P2P message size limits - must be large enough for big blocks.
p2p:
  pubsub_max_size: "50 MiB"
  rpc_max_size: "100 MiB"

# Validators require archiver. The generator enforces presence of provider+token.
archiver:
  enabled: true
  provider_url: "https://archiver.example.com"
  provider_id: "loads3"

# Metrics exposure policy: "localhost" is safest for public testnets without centralized Prometheus.
exposure:
  metrics_bind: "127.0.0.1"

# Testnet override: allow >1 validator per host (unsafe for single-host failure tolerance).
validation:
  allow_unsafe_failure_domains: true

# Blockscout explorer configuration
blockscout:
  enabled: true
  host: blockscout-fibernet
  rpc_node: node-rpc
  domains:
    explorer: fibernet.load.network
    stats: stats.fibernet.load.network
    rpc: rpc.fibernet.load.network
  ssl:
    enabled: true
    email: admin@load.network
